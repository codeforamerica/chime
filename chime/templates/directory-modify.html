{% extends "base.html" %}

{% set template_name = 'articles-list' %}
{% block body_class %}{{template_name}}{% endblock %}

{% set breadcrumb_items = [{'name': 'Activites', 'url': '/'}] %}

{% block title %}Browse{% endblock %}

{% block content %}

<!-- task: {{ activity.task_description }} -->
<!-- beneficiary: {{ activity.task_beneficiary }} -->
<!-- template name: {{ template_name }} -->
{% set icon_class_lookup = {'folder': 'fa fa-folder-o', 'file': 'fa fa-file-text-o', 'category': 'fa fa-folder', 'article': 'fa fa-file-text'} %}
<div class="articles-list__main grid col__flex">
    {% for column in dir_columns %}
    {% if (loop.index != 1 and loop.index != dir_columns|length) or (loop.index == 1 and dir_columns|length == 1) %}
    <div class="dir grid__item {% if loop.index < 4 %}width-one-fourth{% endif %}">
      {% if loop.index == 2 %}
      <h2>Categories</h2>
      <div class="selection-box box-add-file-folder">
        <form action="." method="POST" class="form-one-line">
            <input class="form-one-line__input" name="request_path" placeholder="Add Category" type="text" />
            <input name="create_what" value="category" type="hidden" />
            <input name="create_path" value="{{column['base_path']}}" type="hidden" />
            <input class="form-one-line__submit button" name="action" type="submit" value="Create" />
        </form>
      </div>
      {% elif loop.index == 3 %}
      <h2>Subcategories</h2>
      <div class="selection-box box-add-file-folder">
        <form action="." method="POST" class="form-one-line">
            <input class="form-one-line__input" name="request_path" placeholder="Add Subcategory" type="text" />
            <input name="create_what" value="category" type="hidden" />
            <input name="create_path" value="{{column['base_path']}}" type="hidden" />
            <input class="form-one-line__submit button" name="action" type="submit" value="Create" />
        </form>
      </div>
      {% endif %}
      {% if loop.index != dir_columns|length %}
      <ul class="dir">
        {% for file in column['files'] %}
         <!-- file type: {{file['display_type']}}, file name: {{file['name']}}, file title: {{file['title']}} -->
         <li class="dir-item {% if file['selected'] == True %}is-selected{% endif %}">
            <a class="dir-item__name {{file['display_type']}}" href="{{file['edit_path']}}"><span class="{{icon_class_lookup[file['display_type']]}}"></span>{{ file['title'] }}</a>
            <div class="dir-item__actions toolbar--right">
              <a href="{{file['modify_path']}}" class="toolbar__item"><span class="fa fa-pencil"></span></a>
            </div>
          </li>
        {% endfor %}   
      </ul>
      {% endif %}
    </div>
    {% endif %}
    {% endfor %}
    <div class="grid__item {% if dir_columns|length == 3 %}width-three-fourths{% elif dir_columns|length == 4 %}width-one-half{% endif %} end-row directory-modify">
      {% set dir_title = "Category" %}
      {% if dir_columns|length == 4 %}
        {% set dir_title = "Subcategory" %}
      {% endif %}
      <form action="." method="POST" class="directory-modify__form">
          <input name="order" type="hidden" value="{{ category.order }}" />
          <h3 class="directory-modify__title">{{ dir_title }} Details</h3>
          <label>{{ dir_title }} Name</label>
          <input type="text" value="{{ category.title }}" class="directory-modify__name">
          <label>{{ dir_title }} Description</label>
          <textarea class="directory-modify__description">{{ category.description }}</textarea>
          <div class="directory-modify__action-bar row">
            <div class="row__left toolbar toolbar--left">
              <button name="delete" type="submit" class="button button--red toolbar__item"><span class="fa fa-trash"></span> Delete</button>
            </div>
            <div class="row__right toolbar toolbar--right">
              <a href="{{ category.cancel_path }}" class="button toolbar__item">Cancel</a>
              <button name="save" type="submit" class="button button--green toolbar__item">Save</button>
            </div>

          </div>

      </form>
    </div>
</div>
{% endblock %}

